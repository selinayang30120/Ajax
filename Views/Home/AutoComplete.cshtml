@{
    ViewData["Title"] = "AutoComplete";
}

<h1>AutoComplete</h1>
<div class="container">
    <div class="row mt-3">
        <div class="col-3"></div>
        <div class="col">
            <input type="text" class="form-control mb-3" id="autocomplete">
            <div class="list-group">

            </div>
        </div>
        <div class="col-3"></div>
    </div>
</div>

@section Scripts {
    <script>
        const inputText = document.querySelector("#autocomplete");
        const listData = document.querySelector(".list-group");
        inputText.addEventListener("input", async (event) => {
            //使用者要搜尋的內容
            let keyword = event.target.value;
            listData.style.display = "none";

            if (keyword.length != 0) {
                const url = `@Url.Content("~/api/SpotsTitle/")?keyword=${keyword}`
                const response = await fetch(url)
                const titles = await response.json()

                const htmlTitles = titles.map(title => {
                    return (`<button type="button" class="list-group-item list-group-item-action">${title}</button>`)
                })
                listData.innerHTML = htmlTitles.join("")
                listData.style.display = "block"
            }
        });
    </script>
}

